/**
 * {{ENTITY_NAME_PASCAL}} Routes - Item Endpoints
 *
 * Generated from entity: {{ENTITY_NAME}}
 *
 * Handles item operations: get, update, delete by ID
 * Uses Repository pattern for database operations
 *
 * @generated {{TIMESTAMP}}
 */
import { createApp } from '@spfn/core/route';
import { NotFoundError } from '@spfn/core';
import { get{{ENTITY_NAME_PASCAL}}Repository } from '../../../repositories/{{ENTITY_NAME}}.repository.js';
import {
    get{{ENTITY_NAME_PASCAL_SINGULAR}}Contract,
    update{{ENTITY_NAME_PASCAL_SINGULAR}}Contract,
    delete{{ENTITY_NAME_PASCAL_SINGULAR}}Contract
} from '../contract.js';

const app = createApp();

/**
 * GET /{{ENTITY_NAME}}/:id - Get {{ENTITY_NAME_SINGULAR}} by ID
 */
app.bind(get{{ENTITY_NAME_PASCAL_SINGULAR}}Contract, async (c) => {
    const { id } = c.params;
    const repo = get{{ENTITY_NAME_PASCAL}}Repository();
    const {{ENTITY_NAME_SINGULAR}} = await repo.findById(Number(id));

    if (!{{ENTITY_NAME_SINGULAR}}) {
        throw new NotFoundError('{{ENTITY_NAME_PASCAL_SINGULAR}}', id);
    }

    return c.json({{ENTITY_NAME_SINGULAR}});
});

/**
 * PUT /{{ENTITY_NAME}}/:id - Update {{ENTITY_NAME_SINGULAR}}
 */
app.bind(update{{ENTITY_NAME_PASCAL_SINGULAR}}Contract, async (c) => {
    const { id } = c.params;
    const body = await c.data();

    const repo = get{{ENTITY_NAME_PASCAL}}Repository();
    const updated = await repo.update(Number(id), body);
    return c.json(updated);
});

/**
 * DELETE /{{ENTITY_NAME}}/:id - Delete {{ENTITY_NAME_SINGULAR}}
 */
app.bind(delete{{ENTITY_NAME_PASCAL_SINGULAR}}Contract, async (c) => {
    const { id } = c.params;
    const repo = get{{ENTITY_NAME_PASCAL}}Repository();
    await repo.delete(Number(id));
    return c.json({ success: true });
});

export default app;