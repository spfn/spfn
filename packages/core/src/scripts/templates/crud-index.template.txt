/**
 * ğŸ¤– AUTO-GENERATED CRUD Routes - {{TYPE_NAME}}
 *
 * Generated from entity: {{ENTITY_NAME}}
 *
 * âš ï¸ ìˆ˜ì • ê°€ëŠ¥í•œ íŒŒì¼ì…ë‹ˆë‹¤.
 * ì´ íŒŒì¼ì€ ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œë§Œ ìƒì„±ë©ë‹ˆë‹¤.
 * í•œ ë²ˆ ìƒì„±ëœ í›„ì—ëŠ” ììœ ë¡­ê²Œ ìˆ˜ì •í•˜ì„¸ìš”.
 *
 * @generated {{TIMESTAMP}}
 */
import type { RouteContext } from '@/server/core';
import { getDb } from '@/server/core';
import { {{ENTITY_NAME}} } from '@/server/entities/{{ENTITY_NAME}}';
import type { Create{{TYPE_NAME}}Dto } from '@/types/generated';

export const meta = {
  tags: ['{{ENTITY_NAME}}'],
  description: '{{TYPE_NAME}} CRUD operations',
};

/**
 * GET /{{ENTITY_NAME}} - List all {{ENTITY_NAME}}
 */
export async function GET(c: RouteContext) {
  const db = getDb();
  const all{{TYPE_NAME}}s = await db.select().from({{ENTITY_NAME}});
  return c.json(all{{TYPE_NAME}}s);
}

/**
 * POST /{{ENTITY_NAME}} - Create new {{ENTITY_NAME_SINGULAR}}
 */
export async function POST(c: RouteContext) {
  const body = await c.data<Create{{TYPE_NAME}}Dto>();
  const db = getDb();

  const [new{{TYPE_NAME}}] = await db
    .insert({{ENTITY_NAME}})
    .values(body)
    .returning();

  return c.json(new{{TYPE_NAME}}, 201);
}